<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created on a sunny day by texi2html
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>Singular 2-0-4 Manual: 4.6.5.2 MPtcp links</title>

<meta name="description" content="Singular 2-0-4 Manual: 4.6.5.2 MPtcp links">
<meta name="keywords" content="Singular 2-0-4 Manual: 4.6.5.2 MPtcp links">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:pre}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en"  background="../singular_images/Mybg.png">

<a name="MPtcp-links"></a>
<table border="0" cellpadding="0" cellspacing="0">
<tr valign="top">
<td align="left">
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr valign="top" align="left">
<td valign="middle" align="left">  <a href="index.htm"><img
    src="../singular_images/singular-icon-transparent.png" width="50"
      border="0" alt="Top"></a>
</td>
</tr>
<tr valign="top" align="left">
<td valign="middle" align="left"><a href="sing_97.htm#MPfile-links" title="Previous section in reading order"><img src="../singular_images/a_left.png" border="0" alt="Back: 4.6.5.1 MPfile links" align="middle"></a></td>
</tr>
<tr valign="top" align="left">
<td valign="middle" align="left"><a href="sing_99.htm#DBM-links" title="Next section in reading order"><img src="../singular_images/a_right.png" border="0" alt="Forward: 4.6.6 DBM links" align="middle"></a></td>
</tr>
<tr valign="top" align="left">
<td valign="middle" align="left"><a href="sing_65.htm#Data-types" title="Beginning of this chapter or previous chapter"><img src="../singular_images/a_leftdouble.png" border="0" alt="FastBack: 4 Data types" align="middle"></a></td>
</tr>
<tr valign="top" align="left">
<td valign="middle" align="left"><a href="sing_153.htm#Functions-and-system-variables" title="Next chapter"><img src="../singular_images/a_rightdouble.png" border="0" alt="FastForward: 5 Functions and system variables" align="middle"></a></td>
</tr>
<tr valign="top" align="left">
<td valign="middle" align="left"><a href="sing_96.htm#MP-links" title="Up section"><img src="../singular_images/a_up.png" border="0" alt="Up: 4.6.5 MP links" align="middle"></a></td>
</tr>
<tr valign="top" align="left">
<td valign="middle" align="left"><a href="index.htm#Preface" title="Cover (top) of document"><img src="../singular_images/a_top.png" border="0" alt="Top: 1 Preface" align="middle"></a></td>
</tr>
<tr valign="top" align="left">
<td valign="middle" align="left"><a href="sing_toc.htm#SEC_Contents" title="Table of contents"><img src="../singular_images/a_tableofcon.png" border="0" alt="Contents: Table of Contents" align="middle"></a></td>
</tr>
<tr valign="top" align="left">
<td valign="middle" align="left"><a href="sing_914.htm#Index" title="Index"><img src="../singular_images/a_index.png" border="0" alt="Index: F Index" align="middle"></a></td>
</tr>
<tr valign="top" align="left">
<td valign="middle" align="left"><a href="sing_abt.htm#SEC_About" title="About (help)"><img src="../singular_images/a_help.png" border="0" alt="About: About This Document" align="middle"></a></td>
</tr>
</table>
</td>
<td align="left">
<a name="MPtcp-links-1"></a>
<h4 class="subsubsection">4.6.5.2 MPtcp links</h4>
<a name="index-MPtcp-links"></a>

<p>MPtcp links give the possibility to exchange data in the binary MP
format between two processes which may run on the same or on different
computers. MPtcp links can be opened in four different modes:
</p>
<dl compact="compact">
<dt><code>listen</code></dt>
<dd><p><small>SINGULAR</small> acts as a server.
</p>
</dd>
<dt><code>connect</code></dt>
<dd><p><small>SINGULAR</small> acts as a client.
</p>
</dd>
<dt><code>launch</code></dt>
<dd><p><small>SINGULAR</small> acts as a client, launching an application as server.
</p>
</dd>
<dt><code>fork</code></dt>
<dd><p><small>SINGULAR</small> acts as a client, forking another <small>SINGULAR</small> as
server.
</p></dd>
</dl>

<p>The MPtcp link describing string has to be
</p><ul>
<li> listen mode:
<ol>
<li> <code>&quot;MPtcp:listen --MPport &quot;</code> + portnumber
</li></ol>
<p><small>SINGULAR</small> becomes a server and waits at the port for a
connect call.
</p></li><li> connect mode:
<ol>
<li> <code>&quot;MPtcp:connect --MPport &quot;</code> + portnumber
</li><li> <code>&quot;MPtcp:connect --MPhost &quot;</code> + hostname + <code>&quot; --MPport &quot;</code> +
portnumber
</li></ol>
<p><small>SINGULAR</small> becomes a client and connects to a server waiting at
the host and port.
</p></li><li> launch mode:
<ol>
<li> <code>&quot;MPtcp:launch&quot;</code>
</li><li> <code>&quot;MPtcp:launch --MPrsh &quot;</code> + rsh
</li><li> <code>&quot;MPtcp:launch --MPrsh &quot;</code> + rsh  + <code>&quot; --MPhost &quot;</code> +
hostname
</li><li> <code>&quot;MPtcp:launch --MPrsh &quot;</code> + rsh  + <code>&quot; --MPhost &quot;</code> +
hostname + <code>&quot; --MPapplication &quot;</code> + application
</li></ol>
<p><small>SINGULAR</small> becomes a client and starts (launches) the application
using the specified remote shell command (default is
<code>ssh</code>) on a (possibly) different host (default is <code>localhost</code>
which then acts as a server.
</p></li><li> fork mode:
<ol>
<li> <code>&quot;MPtcp:fork&quot;</code>
</li></ol>
<p><small>SINGULAR</small> becomes a client and forks another <small>SINGULAR</small> on the
same host which acts as a server.
</p></li></ul>

<p>There are the following default values:
</p><ul>
<li> if none of <code>listen</code>, <code>connect</code>, <code>launch</code> or
<code>fork</code> is specified, the default mode is set to <code>fork</code>.

</li><li> if no remote shell (rsh) command is specified, then the command
<code>ssh</code> is used.

</li><li> if no application is specified (in mode <code>launch</code>) the default
application is the value of <code>system(&quot;Singular&quot;) + &quot;-bq&quot;</code>.
(This evaluates to the absolute path of the <small>SINGULAR</small> currently running
with the option <code>&quot;-bq&quot;</code> appended.)

</li><li> if no hostname is specified the local host is used as default host.
</li></ul>

<p>To open an MPtcp link in launch mode, the application to launch must
either be given with an absolute pathname, or must be in a directory
contained in the search path. The launched application acts as a server,
whereas the <small>SINGULAR</small> that actually opened the link acts as a
client. <small>SINGULAR</small> automatically appends the command line arguments
&quot;<code>--MPmode connect --MPhost</code> hostname <code>--MPport</code> portnumber&quot;
to the command line of the server application. Both hostname and
portnumber are substituted by the values from the link
specification. The client &quot;listens&quot; at the given port until the server
application does a connect call. If <small>SINGULAR</small> is used as server
application it has to be started with the command line option <code>-b</code>.
Since launching is done using a remote shell command, the host on which
the application should run must have an entry in the <code>.rhosts</code>
file. Even the local machine must have an entry if applications are to
be launched locally.
</p>
<p>If the MPtcp link is opened in fork mode a child of the current
<small>SINGULAR</small> is forked. All variables and their values are inherited by
the child. The child acts as a server whereas the <small>SINGULAR</small> that
actually opened the link acts as a client.
</p>
<p>To arrange the evaluation of an expression by a server, the expression
must be quoted using the command <code>quote</code> (see <a href="sing_256.htm#quote">quote</a>), so that
a local evaluation is prevented. Otherwise, the expression is evaluated
first, and the result of the evaluation is written, instead of the
expression which is to be evaluated.
</p>
<p>If <small>SINGULAR</small> is in server mode, the value of the variable
<code>mp_ll</code> is the MPtcp link connecting to the client and
<small>SINGULAR</small> is in an infinite read-eval-write loop until the
connection is closed from the client side (by closing its connecting
link). Reading and writing is done to the link <code>mp_ll</code>: After an
expression is read, it is evaluated and the result of the evaluation is
written back.  That is, for each expression which was written to the
server, there is exactly one expression written back. This might be an
&quot;empty&quot; expression, if the evaluation on the server side does not return
a value.
</p>
<p>MPtcp links should explicitly be opened before being used. MPtcp links
are bidirectional, i.e., can be be used for both, writing and
reading. Reading from an MPtcp link blocks until data was written to
that link. The <code>status</code> command can be used to check whether there
is data to read.
</p>
<br><p><strong>Example:</strong>
</p><div class="smallexample">
<pre class="smallexample">  LIB &quot;general.lib&quot;; // needed for &quot;killall&quot; command
  link l=&quot;MPtcp:launch&quot;;
  open(l); l;        // l is ready for writing but not for reading
&rarr; // type : MPtcp
&rarr; // mode : launch
&rarr; // name : 
&rarr; // open : yes
&rarr; // read : not ready
&rarr; // write: ready

  ring r; ideal i=x2+y,xyz+z,x2+y2;

  write (l,quote(std(eval(i))));   // std(i) is computed on server
  def j = read(l);j; // result of computation on server is read
&rarr; j[1]=z
&rarr; j[2]=y2-y
&rarr; j[3]=x2+y2

  write(l, quote(getdump(mp_ll))); // server reads dump
  dump(l);           //  dump is written to server (includes proc's)
  read(l);           // result of previous write-command is read
  killall(&quot;not&quot;, &quot;link&quot;); killall(&quot;proc&quot;); // kills everything, but links
&rarr; // ** killing the basering for level 0

  write(l, quote(dump(mp_ll)));    // server writes dump
  getdump(l);        // dump is read from server
  read(l);           // result of previous write-command is read

  close(l);          // server is shut down
  listvar(all);      // same state as we had before &quot;killall()&quot;
&rarr; // mpsr_r0              [0]  ring
&rarr; // r                    [0]  *ring
&rarr; //      j                    [0]  ideal, 3 generator(s)
&rarr; //      i                    [0]  ideal, 3 generator(s)
&rarr; // l                    [0]  link

  l = &quot;MPtcp:&quot;;      // fork link declaration
  open(l); l;        // Notice that name is &quot;parent&quot;
&rarr; // type : MPtcp
&rarr; // mode : fork
&rarr; // name : parent
&rarr; // open : yes
&rarr; // read : not ready
&rarr; // write: ready

  write(l, quote(status(mp_ll, &quot;name&quot;)));
  read(l);           // and name of forked link is &quot;child&quot;
&rarr; child
  write(l,quote(i)); // Child inherited vars and their values
  read(l);
&rarr; _[1]=x2+y
&rarr; _[2]=xyz+z
&rarr; _[3]=x2+y2
  close(l);          // shut down forked child
</pre></div>

</td>
</tr>
</table>
<hr>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">  <a href="index.htm"><img
    src="../singular_images/singular-icon-transparent.png" width="50"
      border="0" alt="Top"></a>
</td>
<td valign="middle" align="left"><a href="sing_97.htm#MPfile-links" title="Previous section in reading order"><img src="../singular_images/a_left.png" border="0" alt="Back: 4.6.5.1 MPfile links" align="middle"></a></td>
<td valign="middle" align="left"><a href="sing_99.htm#DBM-links" title="Next section in reading order"><img src="../singular_images/a_right.png" border="0" alt="Forward: 4.6.6 DBM links" align="middle"></a></td>
<td valign="middle" align="left"><a href="sing_65.htm#Data-types" title="Beginning of this chapter or previous chapter"><img src="../singular_images/a_leftdouble.png" border="0" alt="FastBack: 4 Data types" align="middle"></a></td>
<td valign="middle" align="left"><a href="sing_153.htm#Functions-and-system-variables" title="Next chapter"><img src="../singular_images/a_rightdouble.png" border="0" alt="FastForward: 5 Functions and system variables" align="middle"></a></td>
<td valign="middle" align="left"><a href="sing_96.htm#MP-links" title="Up section"><img src="../singular_images/a_up.png" border="0" alt="Up: 4.6.5 MP links" align="middle"></a></td>
<td valign="middle" align="left"><a href="index.htm#Preface" title="Cover (top) of document"><img src="../singular_images/a_top.png" border="0" alt="Top: 1 Preface" align="middle"></a></td>
<td valign="middle" align="left"><a href="sing_toc.htm#SEC_Contents" title="Table of contents"><img src="../singular_images/a_tableofcon.png" border="0" alt="Contents: Table of Contents" align="middle"></a></td>
<td valign="middle" align="left"><a href="sing_914.htm#Index" title="Index"><img src="../singular_images/a_index.png" border="0" alt="Index: F Index" align="middle"></a></td>
<td valign="middle" align="left"><a href="sing_abt.htm#SEC_About" title="About (help)"><img src="../singular_images/a_help.png" border="0" alt="About: About This Document" align="middle"></a></td>
</tr></table>
<font size="-1">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; User manual for <a href="http://www.singular.uni-kl.de/"><i>Singular</i></a> version 2-0-4, October 2002,
generated by <a href="http://www.nongnu.org/texi2html/"><i>texi2html</i></a>.
</font>

</body>
</html>
